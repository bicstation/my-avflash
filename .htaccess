# ----------------------------------------------------
# サーバー提供の初期設定 (キャッシュ有効化の制御)
# ----------------------------------------------------
# ----------------------------------------------------
# 【重要】自作MVCモデルの動作保証のための追記設定
# ----------------------------------------------------
<IfModule mod_rewrite.c>
    RewriteEngine On

    # 1. 【最重要: API専用ルート】
    # /api/ から始まるリクエストは、すべて index.php に渡し、
    # ここで処理を終了する ([L]フラグ)。
    RewriteRule ^api/(.*)$ index.php [L]

    # 2. 既存のファイルやディレクトリへのアクセスはそのまま通す（ReactのJS/CSS/画像用）
    # このルールは、APIの後に置くことでAPIリクエストには適用されません。
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d

    # 3. それ以外のすべてのリクエストを index.php に渡す（既存サイトの表示用）
    # これにより、/api/ 以外のすべての動的なページはPHP MVCが処理します。
    RewriteRule ^(.*)$ index.php [L]

</IfModule>
# ----------------------------------------------------
# キャッシュ設定の最終行
# ----------------------------------------------------
SetEnvIf Request_URI ".*" Ngx_Cache_NoCacheMode